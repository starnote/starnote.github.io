(function(t){function e(e){for(var r,o,i=e[0],l=e[1],c=e[2],m=0,d=[];m<i.length;m++)o=i[m],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,i=1;i<n.length;i++){var l=n[i];0!==a[l]&&(r=!1)}r&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={app:0},s=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var u=l;s.push([1,"chunk-vendors"]),n()})({0:function(t,e){},"034f":function(t,e,n){"use strict";var r=n("85ec"),a=n.n(r);a.a},"0cce":function(t,e,n){},1:function(t,e,n){t.exports=n("56d7")},10:function(t,e){},11:function(t,e){},"15cf":function(t,e,n){"use strict";var r=n("945e"),a=n.n(r);a.a},2:function(t,e){},"227d":function(t,e,n){},3:function(t,e){},"35f8":function(t,e,n){"use strict";var r=n("227d"),a=n.n(r);a.a},4:function(t,e){},"43a7":function(t,e,n){"use strict";var r=n("52a6"),a=n.n(r);a.a},"4eda":function(t,e,n){"use strict";var r=n("9b05"),a=n.n(r);a.a},5:function(t,e){},"52a6":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("b-navbar",{staticClass:"navmanu",attrs:{toggleable:"lg",type:"light"}},[r("b-navbar-brand",{on:{click:t.backtoindex}},[r("img",{staticClass:"d-inline-block align-top",attrs:{src:n("950d"),alt:"StarNote"}})]),r("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),r("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[r("b-navbar-nav",{staticClass:"ml-auto"},[r("router-link",{attrs:{to:"/"}},[t._v("主页")]),r("router-link",{attrs:{to:"/title"}},[t._v("新建主题")]),this.$store.state.username?r("div",[r("a",{attrs:{href:"#"}},[t._v("@"+t._s(this.$store.state.username))]),r("a",{attrs:{href:"#"},on:{click:t.logout}},[t._v("注销")])]):r("div",[r("a",{attrs:{href:"https://signup.steemit.com",target:"_blank"}},[t._v("注册")]),r("router-link",{attrs:{to:"/login"}},[t._v("登录")])],1)],1)],1)],1),r("router-view"),r("Footer")],1)},s=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"myfooter"},[n("b-container",{staticClass:"bv-example-row"},[n("b-row",[n("b-col",[n("router-link",{attrs:{to:"/about"}},[t._v("关于星空笔记")])],1),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://steemitwallet.com"}},[t._v("网页钱包")])]),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://github.com/starnote/starnote.github.io"}},[t._v("Github")])]),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://github.com/steemit/steem-js/tree/master/doc#install"}},[t._v("开发手册")])])],1),n("b-row",[n("b-col",[n("router-link",{attrs:{to:"/newbie"}},[t._v("新手指南")])],1),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://github.com/aaroncox/vessel/releases"}},[t._v("桌面钱包")])]),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://github.com/steem-driver/awesome-steem"}},[t._v("AwesomeSteem")])]),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://smt.steem.com"}},[t._v("SMTs")])])],1),n("b-row",[n("b-col",[n("a",{attrs:{target:"_blank",href:"https://steemh.org"}},[t._v("Steem指南")])]),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://steemd.com/@"+this.$store.state.username}},[t._v("区块数据")])]),n("b-col",[n("a",{attrs:{target:"_blank",href:"https://steemprojects.com"}},[t._v("SteemProjects")])]),n("b-col")],1)],1),n("p",{staticClass:"info"},[t._v("Copyright©2019 星空笔记，基于Steem和IPFS的区块链笔记 @lemooljiang创建 QQ:497867999")])],1)},i=[],l={name:"Footer"},c=l,u=(n("15cf"),n("2877")),m=Object(u["a"])(c,o,i,!1,null,"34b6e748",null),d=m.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v(" test ")])},p=[],h=(n("ac1f"),n("1276"),{name:"Test",mounted:function(){var t=(new Date).toISOString().split(".")[0];console.log(111,t);var e="lemooljiang";this.steem.api.getDiscussionsByAuthorBeforeDate(e,null,t,10,(function(t,e){console.log(567,t,e)}))}}),b=h,g=Object(u["a"])(b,f,p,!1,null,"ca819d6a",null),v=g.exports,k={name:"App",data:function(){return{username:"",password:"",keywords:""}},methods:{backtoindex:function(){this.$router.push({path:"/"})},logout:function(){this.$store.commit("clearUser")}},filters:{formatTime:function(t){return t.substring(0,10)}},components:{Footer:d,Test:v},mounted:function(){if(null!=localStorage.getItem("autostart")){console.log(222,"开始点赞啦！");var t=JSON.parse(localStorage.getItem("authors"));this.getDataAndVote(t)}}},_=k,w=(n("034f"),Object(u["a"])(_,a,s,!1,null,null,null)),x=w.exports,y=n("8c4f"),$=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"starnote"}},[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 search",attrs:{id:"inline-form-input-name",placeholder:"搜索"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),r("div",{staticClass:"article"},t._l(t.search(t.keywords),(function(e,a){return r("div",{staticClass:"content"},[r("a",{staticClass:"titleclass",on:{click:function(n){return t.showChapter(a,e.permlink)}}},[r("img",{attrs:{src:n("cdd9"),alt:"StarNote"}}),t._v(" "+t._s(e.title)+" "),r("p",{staticClass:"posttime"},[t._v(t._s(t._f("formatTime")(e.created))+" ")])]),r("b-button",{staticClass:"edittitle",attrs:{variant:"outline-primary"},on:{click:function(n){return t.edit(a,e)}}},[t._v("编辑")]),r("p",{directives:[{name:"show",rawName:"v-show",value:!t.editFlag[a],expression:"!editFlag[key]"}]},[t._v("摘要："+t._s(e.body))]),r("div",{directives:[{name:"show",rawName:"v-show",value:t.editFlag[a],expression:"editFlag[key]"}]},[r("div",{attrs:{id:"main"}},[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 title",attrs:{id:"inline-form-input-name",placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),r("b-form-textarea",{attrs:{id:"textarea",rows:"3","max-rows":"6"},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(n){return t.refresh(a,e)}}},[t._v("更新")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.editclear(a)}}},[t._v("取消")])],1),r("div",{directives:[{name:"show",rawName:"v-show",value:t.flag[a],expression:"flag[key]"}]},[t._l(t.chapters,(function(t,e){return r("div",[r("Replylist",{attrs:{parentmsg:t,ckey:e}})],1)})),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(n){return t.addChapter(e.author,e.permlink,e)}}},[t._v("新增章节")]),t.addFlag?r("div",[r("div",{attrs:{id:"main2"}},[r("div",{staticClass:"subtitle"},[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 title",attrs:{id:"inline-form-input-name",placeholder:"请输入章节名"},model:{value:t.subtitle,callback:function(e){t.subtitle=e},expression:"subtitle"}})],1),r("div",{attrs:{id:"main3"}},[r("mavon-editor",{ref:"md",refInFor:!0,staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1)]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(n){return t.postChapter(e.author,e.permlink,e)}}},[t._v("提交")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e()],2)],1)})),0),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1)],1)},j=[],S=(n("99af"),n("4de4"),n("caad"),n("c975"),n("d3b7"),n("2532"),n("3ca3"),n("159b"),n("ddb0"),n("96cf"),n("1da1")),C=n("2909"),O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"loading"})},P=[],F={name:"Loading"},D=F,A=(n("7f16"),Object(u["a"])(D,O,P,!1,null,"38280d7f",null)),I=A.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item"},[n("div",{staticClass:"child"},[n("a",{staticClass:"subtitle",on:{click:function(e){return t.show(t.ckey)}}},[n("div",{staticClass:"titledown"},[t._v("> "+t._s(t.parentmsg.title)+" ")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.flag[t.ckey],expression:"flag[ckey]"}]},[n("mavon-editor",{staticClass:"replymd",attrs:{value:t.parentmsg.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}}),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.edit(t.parentmsg)}}},[t._v("编辑")])],1)]),t.editFlag?n("div",[n("div",{attrs:{id:"main"}},[n("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 title",attrs:{id:"inline-form-input-name",placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),n("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.upimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),n("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.refresh(t.parentmsg)}}},[t._v("更新")]),n("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e()])},E=[],N={name:"Replylist",data:function(){return{title:"",text:"",editFlag:!1,key:"",flag:[]}},methods:{edit:function(t){this.editFlag=!0,this.title=t.title,this.text=t.body},refresh:function(t){console.log(135,t),this.editFlag=!1,this.$set(t,"title",this.title),this.$set(t,"body",this.text);var e=this.$store.state.password,n=this.$store.state.username,r=t.parent_author,a=t.parent_permlink,s=t.permlink,o=this.title,i=this.text,l=t.json_metadata,c={id:t.id,title:o,author:n,permlink:s,parent_author:r,parent_permlink:a,body:i,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(l)};this.putChapterDB(c),this.postToSteem(e,r,a,n,s,o,i,l)},putChapterDB:function(t){var e=this.$store.state.db,n=this.$store.state.username+"chapter",r=e.transaction([n],"readwrite");r.oncomplete=function(t){console.log("533,事务操作完成")},r.onerror=function(t){console.log("事务操作出错"),console.dir(t)},r.onsuccess=function(t){console.log("事务操作成功")};var a=r.objectStore(n);a.put(t)},clear:function(){this.replyFlag=!1,this.editFlag=!1,this.text=""},show:function(t){this.$set(this.flag,t,!this.flag[t])},upimg:function(t,e){this.imgEdit(t,e)}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},mounted:function(){for(var t=0;t<this.parentmsg.length;t++)this.flag[t]=!1},props:["parentmsg","ckey"]},R=N,T=(n("c8e9"),Object(u["a"])(R,B,E,!1,null,"6ad2f818",null)),L=T.exports,q={name:"Index",data:function(){return{keywords:"",isLoading:!1,flag:[],res:[],temp:[],chapters:[],addFlag:!1,editFlag:[],title:"",body:"",subtitle:"",text:""}},methods:{edit:function(t,e){this.$set(this.editFlag,t,!this.editFlag[t]);for(var n=this.$store.state.posts,r=0;r<n.length;r++)t!=r&&this.$set(this.editFlag,r,!1);this.title=e.title,this.body=e.body},refresh:function(t,e){this.$set(this.editFlag,t,!1),this.$set(e,"title",this.title),this.$set(e,"body",this.body);var n=this.$store.state.password,r=this.$store.state.username,a="",s="starnote",o=e.permlink,i=this.title,l=this.body,c=e.json_metadata,u={id:e.id,title:i,author:r,permlink:o,body:l,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(c)};this.putTitleDB(u),this.postToSteem(n,a,s,r,o,i,l,c)},putTitleDB:function(t){var e=this.$store.state.db,n=this.$store.state.username+"title",r=e.transaction([n],"readwrite");r.oncomplete=function(t){console.log("533,事务操作完成")},r.onerror=function(t){console.log("事务操作出错"),console.dir(t)},r.onsuccess=function(t){console.log("事务操作成功")};var a=r.objectStore(n);a.put(t)},editclear:function(t){this.$set(this.editFlag,t,!1),this.title=this.body=""},getSteemPosts:function(t,e,n,r){var a="2019-12-11T06:40:27",s=this;return new Promise((function(o,i){var l=(new Date).toISOString().split(".")[0];s.steem.api.getDiscussionsByAuthorBeforeDate(t,e,l,n,(function(l,c){var u=[];c.forEach((function(t){t.permlink!==e&&u.push(t)})),r=[].concat(Object(C["a"])(r),u),c.length>1&&c[c.length-1].created>a?s.getSteemPosts(t,c[c.length-1].permlink,n,r).then(o).catch(i):o(r)}))}))},filterPosts:function(t){var e=[];return t.forEach((function(t){"starnote"===t.category&&e.push(t)})),console.log(666,e),e},savePosts:function(t,e){var n=this,r=this.$store.state.username+"title",a=t.transaction([r],"readwrite");return new Promise((function(t){a.oncomplete=function(e){console.log("111, 事务操作完成"),t()},a.onerror=function(t){console.log("事务操作出错"),console.dir(t)},a.onsuccess=function(t){console.log("222, 事务操作成功")};for(var s=a.objectStore(r),o=e.length-1;o>-1;o--)s.add(e[o]);var i=n.$store.state.username;localStorage.setItem(i,"starnote")}))},saveChapters:function(t,e,n){var r=this.$store.state.username+"chapter",a=t.transaction([r],"readwrite");return new Promise((function(t){a.oncomplete=function(e){console.log("121, 事务操作完成"),t()},a.onerror=function(t){console.log("事务操作出错"),console.dir(t)},a.onsuccess=function(t){console.log("222, 事务操作成功")};for(var s=a.objectStore(r),o=0;o<e.length;o++)s.add(e[o]);var i=n;localStorage.setItem(i,"starnote")}))},search:function(t){var e=this.$store.state.posts;return e.filter((function(e){if(e.title.includes(t))return e}))},showChapter:function(t,e){this.chapters=[],this.$set(this.flag,t,!this.flag[t]);for(var n=this.$store.state.posts,r=0;r<n.length;r++)t!=r&&this.$set(this.flag,r,!1);var a=this.$store.state.db,s=this.$store.state.username,o=this,i=e;if(null==localStorage.getItem(i)){var l=function(){var t=Object(S["a"])(regeneratorRuntime.mark((function t(e,n){var r,s,l=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return l.length>2&&void 0!==l[2]?l[2]:[],t.next=3,o.steem.api.getContentRepliesAsync(e,n);case 3:if(r=t.sent,s=[],!(r.length>1)){t.next=12;break}return r.forEach((function(t){t.author===e&&s.push(t)})),o.chapters=s,t.next=10,o.saveChapters(a,s,n);case 10:t.next=13;break;case 12:localStorage.setItem(i,"starnote");case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();l(s,e)}else{console.log(566,"从数据库取");var c=this;this.getAllChapters(a).then((function(t){t.forEach((function(t){t.parent_permlink===e&&c.chapters.push(t)}))}))}},addChapter:function(){this.addFlag=!0},postChapter:function(t,e,n){this.addFlag=!1;var r=this.$store.state.password,a=this.$store.state.username,s=this.getstr(),o=this.subtitle,i=this.text,l=["starnote","cn"],c={tags:l,app:"steemit/1.0",format:"markdown"},u={parent_author:t,parent_permlink:e,title:o,author:a,permlink:s,body:i,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(c)};this.chapters.push(u);var m=this.$store.state.db,d=this.$store.state.username+"chapter",f=m.transaction([d],"readwrite");f.oncomplete=function(t){console.log("233，事务操作完成")},f.onerror=function(t){console.log("事务操作出错"),console.dir(t)},f.onsuccess=function(t){console.log("事务操作成功")};var p=f.objectStore(d);p.add(u),this.postToSteem(r,t,e,a,s,o,i,c),this.subtitle=this.text=""},clear:function(){this.addFlag=!1,this.editFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},filters:{formatTime:function(t){return t.substring(0,10)}},components:{Loading:I,Replylist:L},watch:{temp:function(){this.chapters=this.temp}},mounted:function(){var t=this;function e(){return n.apply(this,arguments)}function n(){return n=Object(S["a"])(regeneratorRuntime.mark((function e(){var n,r,a,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.$store.state.username){e.next=31;break}if(null!=localStorage.getItem(t.$store.state.username)){e.next=27;break}return console.log(166,"第一次登录"),t.isLoading=!0,e.next=6,t.getSteemPosts(t.$store.state.username,null,100,[]);case 6:if(n=e.sent,r=t.filterPosts(n),console.log(888,r),!(r.length>0)){e.next=21;break}return t.$store.commit("savePosts",r),e.next=13,t.initDatabase();case 13:return a=e.sent,t.$store.commit("saveDB",a),e.next=17,t.savePosts(a,r);case 17:for(t.isLoading=!1,s=0;s<n.length;s++)t.flag[s]=!1;e.next=25;break;case 21:t.isLoading=!1,o=this.$store.state.username,localStorage.setItem(o,"starnote"),alert("请创建主题");case 25:e.next=29;break;case 27:if(0!=t.$store.state.posts){e.next=29;break}return e.delegateYield(regeneratorRuntime.mark((function e(){var n,r,a,s,o,i,l,c,u,m,d,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.initDatabase();case 2:return n=e.sent,t.$store.commit("saveDB",n),e.next=6,t.getAllPosts(n);case 6:for(r=e.sent,t.$store.commit("savePosts",r.reverse()),a=0;a<r.length;a++)t.flag[a]=!1;for(s=0;s<r.length;s++)t.editFlag[s]=!1;o=r[0].created,i=[],r.forEach((function(t){i.push(t.permlink)})),l=t.$store.state.username,c=(new Date).toISOString().split(".")[0],u=[],m=null;case 17:return e.next=20,t.steem.api.getDiscussionsByAuthorBeforeDateAsync(l,m,c,10);case 20:if(d=e.sent,!(o<d[0].created&&-1===i.indexOf(d[0].permlink))){e.next=29;break}if(d.forEach((function(t){"starnote"===t.category&&-1===i.indexOf(t.permlink)&&u.push(t)})),m=d[d.length-1].permlink,!(o>d[d.length-1].created)){e.next=27;break}return console.log(233,"没有更新的主题"),e.abrupt("break",33);case 27:e.next=31;break;case 29:return console.log(133,"没有新主题"),e.abrupt("break",33);case 31:e.next=17;break;case 33:if(!(u.length>0)){e.next=41;break}return e.next=36,t.savePosts(n,u);case 36:return console.log(544,"添加新主题成功！"),e.next=39,t.getAllPosts(n);case 39:f=e.sent,t.$store.commit("savePosts",f.reverse());case 41:case"end":return e.stop()}}),e)}))(),"t0",29);case 29:e.next=32;break;case 31:t.$router.push({path:"/login"});case 32:case"end":return e.stop()}}),e,this)}))),n.apply(this,arguments)}e()}},M=q,J=(n("4eda"),Object(u["a"])(M,$,j,!1,null,"40f9ab5f",null)),U=J.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login"},[n("h2",[t._v("用户登录")]),n("div",[n("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 user",attrs:{id:"inline-form-input-name",placeholder:"请输入用户名"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),n("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 user",attrs:{id:"inline-form-input-password",type:"password",placeholder:"请输入发贴密钥（posting key）"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),n("div",{staticClass:"loginbtn"},[n("b-button",{attrs:{variant:"outline-primary"},on:{click:t.login}},[t._v("登录")])],1),n("transition",{attrs:{name:"fade"}},[t.isLoading?n("loading"):t._e()],1)],1)])},z=[],Q={name:"Login",data:function(){return{username:"",password:"",isLoading:!1}},methods:{login:function(){this.isLoading=!0;var t=this,e=this.username;this.steem.api.getAccountHistory(e,0,0,(function(e,n){0===n.length&&(t.isLoading=!1,alert("用户不存在！"))})),this.steem.api.getAccounts([t.username],(function(e,n){var r,a=n[0].posting.key_auths[0][0],s=t.password;try{r=t.steem.auth.wifIsValid(s,a)}catch(o){r="false"}!0===r?(t.isLoading=!1,t.$store.commit("saveUser",{username:t.username,password:s}),t.$router.push({path:"/"})):alert("错误！请检查用户名和发贴密钥！")}))}},components:{Loading:I}},K=Q,W=(n("35f8"),Object(u["a"])(K,V,z,!1,null,"0b2fa036",null)),Y=W.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"maintop"}},[n("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 title",attrs:{id:"inline-form-input-name",placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),n("div",{attrs:{id:"main"}},[n("b-form-textarea",{attrs:{id:"textarea",placeholder:"请输入摘要",rows:"3","max-rows":"6"},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1),n("br"),n("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"inline-form-input-name",placeholder:"tags  (输入英文标签，以空格分隔)"},model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}}),n("div",{staticClass:"btn"},[n("b-button",{attrs:{variant:"outline-primary"},on:{click:t.post}},[t._v("提交")])],1)],1)},H=[],X=(n("498a"),{name:"Post",data:function(){return{db:{},body:"",title:"",tags:""}},methods:{post:function(){var t=this.$store.state.password,e="",n="starnote",r=this.$store.state.username,a=this.getstr(),s=this.title,o=this.body,i="starnote "+this.tags,l=i.trim().split(/\s+/),c={tags:l,app:"steemit/1.0",format:"markdown"};this.postToSteem(t,e,n,r,a,s,o,c);var u={title:s,author:r,permlink:a,parent_author:"",parent_permlink:"starnote",category:"starnote",body:o,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(c)},m=this,d=this.$store.state.db,f=this.$store.state.username+"title";function p(){return new Promise((function(t){var e=d.transaction([f],"readwrite");e.oncomplete=function(t){console.log("事务操作完成")},e.onerror=function(t){console.log("事务操作出错"),console.dir(t)},e.onsuccess=function(t){console.log("事务操作成功")};var n=e.objectStore(f);n.add(u),t()}))}function h(){return b.apply(this,arguments)}function b(){return b=Object(S["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p();case 2:return t.next=4,m.getAllPosts(d);case 4:e=t.sent,m.$store.commit("savePosts",e.reverse()),m.$router.push({path:"/"});case 7:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}h()}},mounted:function(){var t=this;function e(){return n.apply(this,arguments)}function n(){return n=Object(S["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.$store.state.username){e.next=12;break}if(0!=t.$store.state.posts){e.next=10;break}return e.next=4,t.initDatabase();case 4:return n=e.sent,t.$store.commit("saveDB",n),e.next=8,t.getAllPosts(n);case 8:r=e.sent,t.$store.commit("savePosts",r.reverse());case 10:e.next=13;break;case 12:t.$router.push({path:"/login"});case 13:case"end":return e.stop()}}),e)}))),n.apply(this,arguments)}e()}}),Z=X,tt=(n("43a7"),Object(u["a"])(Z,G,H,!1,null,"9ed57588",null)),et=tt.exports,nt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},rt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"content"}},[n("h1",[t._v("关于星空笔记")]),n("img",{attrs:{src:"https://www.steemjiang.com:8081/ipfs/Qmf1KNVAxc3oEmYTWnu2NrCKCkhs6xVkCbuRsd2F8Asmbq",alt:"星空笔记"}}),n("br"),n("br"),t._v(" 星空笔记，基于Steem和IPFS的区块链笔记，@lemooljiang创建。数据存储在Steem区块链上，图片存在IPFS网络中，前端则使用IndexedDB数据库，几者相结合，有着神奇的效果！"),n("br"),n("br"),t._v(" 星空笔记是一个去中心的应用！ 它和比特币的离线钱包类似，可以很方便地在本地构建，无需服务器。"),n("br"),n("br"),t._v(" 当然，为了方便大家使用，我把它上传到github page中，大家可以直接访问：https://starnote.github.io"),n("br"),n("br"),n("h4",[t._v("本地构建说明")]),t._v(" 本地环境：Apache 或 Nginx"),n("br"),t._v(" 仓库地址： https://github.com/starnote/starnote.github.io"),n("br"),t._v(" 将仓库中的“index.html” 和 “static” 下载到本地，放进Apache 或 Nginx的根目录即可，http://localhost"),n("br"),n("br")])}],at={name:"About",data:function(){return{}},mounted:function(){}},st=at,ot=(n("f4c6"),Object(u["a"])(st,nt,rt,!1,null,"1687e63e",null)),it=ot.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"content"}},[n("h1",[t._v("新手生存指南")]),t._m(0),n("div",{staticClass:"newtext"},[n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/3f5j36-steem",target:"_blank"}},[t._v("1、steem介绍")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/4xxuhj",target:"_blank"}},[t._v("2、翻墙注册（更新版）")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/4kkmhd",target:"_blank"}},[t._v("3、发贴赚钱")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/4mddsq",target:"_blank"}},[t._v("4、图文编辑三板斧（更新版）")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/3xqvw9",target:"_blank"}},[t._v("5、工具红宝书")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/supload",target:"_blank"}},[t._v("6、新图床supload，顺便赚点比特币")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/p",target:"_blank"}},[t._v("7、P图神技")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/3xem6o",target:"_blank"}},[t._v("8、快速查询及归类")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/3s29oy",target:"_blank"}},[t._v("9、勤于打扫，与垃圾号绝交")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/6hgzux",target:"_blank"}},[t._v("10、一分钟注册新帐户（需要付费）")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/markdown-steemit",target:"_blank"}},[t._v("11、Markdown语法规范")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/4rxtdx",target:"_blank"}},[t._v("12、好玩的表情包和字体图标")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/km1n4",target:"_blank"}},[t._v("13、极速提现")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/6jrje-steemit",target:"_blank"}},[t._v("14、steemit上的长跑")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/2dfqrq",target:"_blank"}},[t._v("15、密码即一切")]),n("br"),n("router-link",{attrs:{to:"/searcharticle/@lemooljiang/steem-dapp",target:"_blank"}},[t._v("16、基于steem的应用DAPP")]),n("br")],1)])},ct=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticStyle:{"margin-left":"15%"}},[n("img",{attrs:{src:"https://i.loli.net/2019/11/24/bsO5WDuaBonL7Uv.jpg",alt:"steem",id:"newbie"}})])}],ut={name:"Newbie",data:function(){return{}},mounted:function(){}},mt=ut,dt=(n("f0bc"),Object(u["a"])(mt,lt,ct,!1,null,"1345dcd4",null)),ft=dt.exports;r["default"].use(y["a"]);var pt=[{path:"/",name:"index",component:U},{path:"/title",name:"title",component:et},{path:"/login",name:"login",component:Y},{path:"/about",name:"about",component:it},{path:"/newbie",name:"newbie",component:ft}],ht=new y["a"]({mode:"history",base:"/",routes:pt}),bt=ht,gt=n("2f62"),vt=n("9c40"),kt=n.n(vt);r["default"].use(gt["a"]);var _t=new gt["a"].Store({state:{username:kt.a.get("username"),password:kt.a.get("password"),posts:[],db:{}},mutations:{saveUser:function(t,e){t.username=e.username,t.password=e.password,kt.a.set("username",e.username,"30d"),kt.a.set("password",e.password,"30d")},savePosts:function(t,e){t.posts=e},saveDB:function(t,e){t.db=e},clearUser:function(t){t.username=null,t.password=null,kt.a.remove("username"),kt.a.remove("password")}},actions:{},modules:{}}),wt=n("6f38"),xt=(n("d52a"),n("edc99"),n("9584")),yt=n.n(xt),$t=(n("9bad"),n("f64c")),jt=n.n($t),St=n("4fce"),Ct=n.n(St),Ot=function(){function t(t,e){for(var n="",r=t;r>0;--r)n+=e[Math.floor(Math.random()*e.length)];return n}return t(5,"0123456789abcdefghijklmnopqrstuvwxyz")},Pt=n("a352"),Ft=n("b23d"),Dt=function(){var t,e,n=this.$store.state.username,r=this.$store.state.username+"title",a=this.$store.state.username+"chapter",s=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB;return s||alert("你的浏览器不支持IndexedDB!\n建议使用brave、 chrome 、opera等浏览器！"),new Promise((function(o){e=s.open(n,1),e.onupgradeneeded=function(e){if(console.log("数据库创建或更新"),t=e.target.result,!t.objectStoreNames.contains(r)){var n=t.createObjectStore(r,{keyPath:"id",autoIncrement:!0});n.createIndex("title","title",{unique:!1})}if(!t.objectStoreNames.contains(a)){var s=t.createObjectStore(a,{keyPath:"id",autoIncrement:!0});s.createIndex("title","title",{unique:!1})}},e.onsuccess=function(e){t=e.target.result,console.log(666,"db版本号",t.version),t.onerror=function(t){alert("Database error:"+t.target.errorCode),console.dir(t.target)},o(t)},e.onerror=function(t){console.log(t,"数据库打开错误")}}))},At=function(t){var e=this.$store.state.username+"title",n=t.transaction([e],"readwrite"),r=n.objectStore(e),a=[];return new Promise((function(t){r.openCursor().onsuccess=function(e){var n=e.target.result;n?(a.push(n.value),n.continue()):t(a)},r.openCursor().onerror=function(t){console.dir(t)}}))},It=function(t){var e=this.$store.state.username+"chapter",n=t.transaction([e],"readwrite"),r=n.objectStore(e),a=[];return new Promise((function(t){r.openCursor().onsuccess=function(e){var n=e.target.result;n?(a.push(n.value),n.continue()):t(a)},r.openCursor().onerror=function(t){console.dir(t)}}))},Bt=function(t,e,n,r,a,s,o,i){this.steem.broadcast.comment(t,e,n,r,a,s,o,i,(function(t,e){console.log(123456,t,e),t&&alert("错误！未能同步到Steem区块链上！\n可能因为你的RC不足，\n或是发贴间隔小于5分钟，\n或是网络不通！\n"+t)}))};r["default"].use(wt["a"]),r["default"].use(kt.a),r["default"].use(yt.a),jt.a.api.setOptions({url:"https://anyx.io"}),r["default"].prototype.steem=jt.a;var Et=Ct()({host:"steemjiang.com",port:"9001",protocol:"https"});r["default"].prototype.ipfs=Et,r["default"].prototype.getstr=Ot,r["default"].prototype.imgAdd=Pt["a"],r["default"].prototype.imgEdit=Ft["a"],r["default"].prototype.initDatabase=Dt,r["default"].prototype.getAllPosts=At,r["default"].prototype.getAllChapters=It,r["default"].prototype.postToSteem=Bt,r["default"].config.productionTip=!1,new r["default"]({router:bt,store:_t,render:function(t){return t(x)}}).$mount("#app")},6:function(t,e){},7:function(t,e){},"7f16":function(t,e,n){"use strict";var r=n("e22e"),a=n.n(r);a.a},8:function(t,e){},"85ec":function(t,e,n){},"8f31":function(t,e,n){},9:function(t,e){},"945e":function(t,e,n){},"950d":function(t,e,n){t.exports=n.p+"img/starnote.26cde6a3.svg"},"9b05":function(t,e,n){},a1c2:function(t,e,n){},a352:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r}));n("d3b7");var r=function(e,n){var r="https://www.steemjiang.com:8081/ipfs/",a=this,s=function(e){return new Promise((function(n,r){var s=t.from(e.result);a.ipfs.add(s).then((function(t){n(t[0].hash)})).catch((function(t){console.error(t),r(t)}))}))},o=new FileReader;o.readAsArrayBuffer(n),o.onloadend=function(t){s(o).then((function(t){a.$refs.md[0].$img2Url(e,r+t)}))}}}).call(this,n("b639").Buffer)},b23d:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r}));n("d3b7");var r=function(e,n){var r="https://www.steemjiang.com:8081/ipfs/",a=this,s=function(e){return new Promise((function(n,r){var s=t.from(e.result);a.ipfs.add(s).then((function(t){n(t[0].hash)})).catch((function(t){console.error(t),r(t)}))}))},o=new FileReader;o.readAsArrayBuffer(n),o.onloadend=function(t){s(o).then((function(t){a.$refs.md.$img2Url(e,r+t)}))}}}).call(this,n("b639").Buffer)},c8e9:function(t,e,n){"use strict";var r=n("8f31"),a=n.n(r);a.a},cdd9:function(t,e,n){t.exports=n.p+"img/star.59dd5406.svg"},e22e:function(t,e,n){},f0bc:function(t,e,n){"use strict";var r=n("0cce"),a=n.n(r);a.a},f4c6:function(t,e,n){"use strict";var r=n("a1c2"),a=n.n(r);a.a}});
//# sourceMappingURL=app.f5e91a92.js.map